
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>CHEBFUN2 GUIDE 1: GETTING STARTED</title><meta name="generator" content="MATLAB 8.1"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2013-11-26"><meta name="DC.source" content="guide1.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, tt, code { font-size:12px; }
pre { margin:0px 0px 20px; }
pre.error { color:red; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>CHEBFUN2 GUIDE 1: GETTING STARTED</h1><!--introduction--><p>A. Townsend, March 2013</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">1.1  WHAT IS A CHEBFUN2?</a></li><li><a href="#5">1.2 WHAT IS A CHEBFUN2V?</a></li><li><a href="#6">1.3 CONSTRUCTING CHEBFUN2 OBJECTS</a></li><li><a href="#11">1.4 BASIC OPERATIONS</a></li><li><a href="#20">1.5 CHEBFUN2 METHODS</a></li><li><a href="#22">1.6 OBJECT COMPOSITION</a></li><li><a href="#23">1.7 WHAT TO DO NOW</a></li><li><a href="#24">1.8 REFERENCES</a></li></ul></div><h2>1.1  WHAT IS A CHEBFUN2?<a name="1"></a></h2><p>A chebfun2 is a function of two variables defined on a rectangle <img src="guide1_eq40471.png" alt="$[a,b]\times[c,d]$">. The syntax for chebfun2 objects is similar to the syntax for matrices in Matlab. Chebfun2 objects have many Matlab commands overloaded. For instance, trace(f) returns the sum of the diagonal entries when <img src="guide1_eq85998.png" alt="$f$"> is a matrix and returns the integral of <img src="guide1_eq32153.png" alt="$f(x,x)$"> when <img src="guide1_eq85998.png" alt="$f$"> is a chebfun2.</p><p>Chebfun2 builds on Chebfun, a well-established software system for univariate functions [Trefethen &amp; others]. Chebfun was first released in 2004 [Battles &amp; Trefethen], and Chebfun2 is the first extension of Chebfun to functions of two variables.</p><p>The implementation of Chebfun2 exploits the observation that many functions of two variables can be well approximated by low rank approximants. A rank 1 function is of the form <img src="guide1_eq60791.png" alt="$u(y)v(x)$">, and a rank k function can be written as the sum of k rank 1 functions. Smooth functions tend to be well approximated by functions of low rank. Chebfun2 makes use of an adaptive procedure to automatically determine low rank function approximations by means of an algorithm that can be viewed as an iterative application of Gaussian elimination with complete pivoting [Townsend &amp; Trefethen March 2013].</p><p>The underlying function representations are related to work by Carvajal, Chapman and Geddes [Carvajal, Chapman, &amp; Geddes 2008] and others including Bebendorf [Bebendorf 2008], Hackbusch, Khoromshij, Oseledets, and Tyrtyshnikov.</p><h2>1.2 WHAT IS A CHEBFUN2V?<a name="5"></a></h2><p>Chebfun2 can represent scalar valued functions, such as <img src="guide1_eq70730.png" alt="$e^{x+y}$">, and vector valued functions, such as <img src="guide1_eq98058.png" alt="$[e^{x+y};\cos(x-y)]$">.  We represent vector valued functions as chebfun2v objects, and these are useful for performing vector calculus. For information about chebfun2v objects and vector calculus see Chapters 5 and 6 of this guide.</p><h2>1.3 CONSTRUCTING CHEBFUN2 OBJECTS<a name="6"></a></h2><p>A chebfun2 is constructed by supplying the Chebfun2 constructor with a function handle or string. The default rectangular domain of a chebfun2 is <img src="guide1_eq51130.png" alt="$[-1,1]\times [-1,1]$">. (An example showing how to specify a different domain is given at the end of this chapter.) For example, here is how to make a chebfun2 that represents <img src="guide1_eq20574.png" alt="$\cos(xy)$"> on <img src="guide1_eq23366.png" alt="$[-1,1]\times[-1,1]$"> and then plot it.</p><pre class="codeinput">f = chebfun2(@(x,y) cos(x.*y));
plot(f), zlim([-2 2])
</pre><img vspace="5" hspace="5" src="guide1_01.png" alt=""> <p>There are several different ways to plot a chebfun2, such as plot, contour, surf, and mesh.  Here is a contour plot of <img src="guide1_eq85998.png" alt="$f$">:</p><pre class="codeinput">contour(f), axis <span class="string">square</span>
</pre><img vspace="5" hspace="5" src="guide1_02.png" alt=""> <p>One way to find the rank of the approximant used to represent <img src="guide1_eq92331.png" alt="$f(x,y)$"> is the following:</p><pre class="codeinput">length(f)
</pre><pre class="codeoutput">ans =
     7
</pre><p>Alternatively, more information can be given by displaying the chebfun2 object:</p><pre class="codeinput">f
</pre><pre class="codeoutput">f = 
chebfun2 object: (1 smooth surface)
       domain                 rank       corner values
[  -1,   1] x [  -1,   1]        7     [0.54 0.54 0.54 0.54]
vertical scale =   1 
</pre><p>The corner values are the values of the chebfun2 at <img src="guide1_eq91850.png" alt="$(-1,-1)$">, <img src="guide1_eq53172.png" alt="$(-1,1)$">, <img src="guide1_eq19844.png" alt="$(1,-1)$">, and <img src="guide1_eq46021.png" alt="$(1,1)$">, in that order. The vertical scale is used by operations to aim for essentially machine precision relative to that number.</p><h2>1.4 BASIC OPERATIONS<a name="11"></a></h2><p>Once we have a chebfun2 we can compute interesting quantities such as its definite double integral:</p><pre class="codeinput">sum2(f)
</pre><pre class="codeoutput">ans =
   3.784332281468732
</pre><p>We can compare this with the true answer obtained by calculus:</p><pre class="codeinput">exact = 3.784332281468732
</pre><pre class="codeoutput">exact =
   3.784332281468732
</pre><p>We can also evaluate a chebfun2 at a point <img src="guide1_eq57428.png" alt="$(x,y)$">, or along a line. When evaluating along a line a chebfun is returned because the answer is a function of one variable.</p><p>Evaluation at a point:</p><pre class="codeinput">x = 2*rand - 1; y = 2*rand - 1;
f(x,y)
</pre><pre class="codeoutput">ans =
   0.998921453908142
</pre><p>Evaluation along the line <img src="guide1_eq00347.png" alt="$y = \pi/6$">:</p><pre class="codeinput">f(:,pi/6)
</pre><pre class="codeoutput">ans = 
   chebfun column (1 smooth piece)
       interval       length   endpoint values   
[      -1,       1]       11     0.87     0.87   
vertical scale =   1 
</pre><p>There are plenty of other questions that may be of interest.  For instance, what are the zero contours of <img src="guide1_eq15447.png" alt="$f(x,y) - .95$">?</p><pre class="codeinput">r = roots(f-.95);
plot(r), axis <span class="string">square</span>, title(<span class="string">'Zero contours of f-.95'</span>)
</pre><img vspace="5" hspace="5" src="guide1_03.png" alt=""> <p>What is the partial derivative <img src="guide1_eq47994.png" alt="$\partial f/\partial y$">?</p><pre class="codeinput">fy = diff(f,1,1);
plot(fy)
</pre><img vspace="5" hspace="5" src="guide1_04.png" alt=""> <p>The syntax for the DIFF command can cause confusion because we are following the matrix syntax in Matlab. We also offer DIFFX(f,k) and DIFFY(f,k) which differentiate <img src="guide1_eq92331.png" alt="$f(x,y)$"> k-times in the first and second variable, respectively.</p><p>What is the mean value of <img src="guide1_eq92331.png" alt="$f(x,y)$"> on <img src="guide1_eq23366.png" alt="$[-1,1]\times[-1,1]$">?</p><pre class="codeinput">mean2(f)
</pre><pre class="codeoutput">ans =
   0.946083070367183
</pre><h2>1.5 CHEBFUN2 METHODS<a name="20"></a></h2><p>There are over 100 methods that can be applied to chebfun2 objects. For a complete list type:</p><pre class="codeinput">methods <span class="string">chebfun2</span>
</pre><pre class="codeoutput">
Methods for class chebfun2:

abs            discriminant   length         pol2cart       sum2           
cdr            display        log            potential      surf           
chebfun2       ellipsoid      max            power          surface        
chebpoly2      exp            max2           prod           surfacearea    
chebpolyplot   feval          mean           quad2d         surfc          
chebpolyplot2  flipdim        mean2          quiver         surfl          
chebpolyval2   fliplr         median         quiver3        svd            
complex        flipud         mesh           rank           tan            
conj           fred           meshc          rdivide        tand           
contour        get            meshz          real           tanh           
contourf       grad           min            restrict       times          
cos            gradient       min2           roots          trace          
cosh           horzcat        minandmax2     sin            transpose      
ctranspose     imag           minus          sinh           uminus         
cumprod        integral       mldivide       size           uplus          
cumsum         integral2      movie          sph2cart       vertcat        
cumsum2        isempty        mrdivide       sphere         volt           
dblquad        isequal        mtimes         sqrt           waterfall      
del2           isreal         norm           squeeze        
diag           jacobian       pivotplot      std            
diff           lap            pivots         std2           
diffx          laplacian      plot           subsref        
diffy          ldivide        plus           sum            

</pre><p>Most of these commands have been overloaded from Matlab. More information about a Chebfun2 command can be found with the help command; for instance</p><pre class="codeinput">help <span class="string">chebfun2/max2</span>
</pre><pre class="codeoutput"> MAX2 Global maximum of a chebfun2
 
  Y = MAX2(F) returns the global maximum of F over its domain. 
    
  [Y X] = MAX2(F) returns the global maximum in Y and its location X.  
 
  For high accuracy results this command requires the Optimization Toolbox.
  
  See also MIN2, MINANDMAX2.

</pre><h2>1.6 OBJECT COMPOSITION<a name="22"></a></h2><p>So far, in this chapter, chebfun2 objects have been constructed explicitly via the command chebfun2(...). However, another useful way to construct new chebfun2 objects is by composing them together with operations such as '+', '-', '.*', and '.^'. For instance,</p><pre class="codeinput">x = chebfun2(@(x,y) x, [-2 3 -4 4]);
y = chebfun2(@(x,y) y, [-2 3 -4 4]);

f = 1./( 2 + cos(.25 + x.^2.*y + y.^2) );
contour(f), axis <span class="string">square</span>
</pre><img vspace="5" hspace="5" src="guide1_05.png" alt=""> <h2>1.7 WHAT TO DO NOW<a name="23"></a></h2><p>To find out more about Chebfun2 you can continue reading this guide, or have a look at the Chebfun2 Examples. This guide and the Chebfun2 Examples are written as publishable m-files. For example, you can publish this chapter of the guide by typing publish('guide1.m').</p><h2>1.8 REFERENCES<a name="24"></a></h2><p>[Battles &amp; Trefethen 2004] Z. Battles and L. N. Trefethen, "An extension of Matlab to continuous functions and operators", SIAM Journal on Scientific Computing, 25 (2004), 1743-1770.</p><p>[Bebendorf 2008] M. Bebendorf, Hierarchical Matrices: A Means to Efficiently Solve Elliptic Boundary Value Problems, Springer, 2008.</p><p>[Carvajal, Chapman, &amp; Geddes 2008] O. A. Carvajal, F. W. Chapman and K. O. Geddes, Hybrid symbolic-numeric integration in multiple dimensions via tensor-product series, Proceedings of ISSAC'05, M. Kauers, ed., ACM Press, 2005, pp.84-91.</p><p>[Townsend &amp; Trefethen 2013] A. Townsend and L. N. Trefethen, An extension of Chebfun to two dimensions, submitted.</p><p>[Townsend &amp; Trefethen March 2013] A. Townsend and L. N. Trefethen, Gaussian elimination as an iterative algorithm, SIAM News, March 2013.</p><p>[Trefethen &amp; others] Chebfun Version 4.2, The Chebfun Development Team, 2011, <a href="http://www.maths.ox.ac.uk/chebfun/">http://www.maths.ox.ac.uk/chebfun/</a></p><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2013a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% CHEBFUN2 GUIDE 1: GETTING STARTED
% A. Townsend, March 2013

%% 1.1  WHAT IS A CHEBFUN2?
% A chebfun2 is a function of two variables defined on a rectangle
% $[a,b]\times[c,d]$. The syntax for chebfun2 objects is similar to the syntax 
% for matrices in Matlab. Chebfun2 objects have many Matlab commands
% overloaded. For instance, trace(f) returns the sum of the diagonal entries
% when $f$ is a matrix and returns the integral of $f(x,x)$ when $f$ is a chebfun2. 

%%
% Chebfun2 builds on Chebfun, a well-established software system for 
% univariate functions [Trefethen & others]. Chebfun was first released
% in 2004 [Battles & Trefethen], and Chebfun2 is the first extension of
% Chebfun to functions of two variables.

%%
% The implementation of Chebfun2 exploits the observation that many
% functions of two variables can be well approximated by low rank approximants.
% A rank 1 function is of the form $u(y)v(x)$, and a rank k function can be
% written as the sum of k rank 1 functions. Smooth functions tend to be 
% well approximated by functions of low rank.  
% Chebfun2 makes use of an adaptive procedure to automatically
% determine low rank function approximations by means of an algorithm that 
% can be viewed as an iterative application of Gaussian elimination with 
% complete pivoting [Townsend & Trefethen March 2013]. 

%% 
% The underlying function representations are related to work by Carvajal, 
% Chapman and Geddes [Carvajal, Chapman, & Geddes 2008] and others including
% Bebendorf [Bebendorf 2008], Hackbusch, Khoromshij, Oseledets, and Tyrtyshnikov.

%% 1.2 WHAT IS A CHEBFUN2V?
% Chebfun2 can represent scalar valued functions, such as $e^{x+y}$, and
% vector valued functions, such as $[e^{x+y};\cos(x-y)]$.  We represent 
% vector valued functions as chebfun2v objects, and these are useful for
% performing vector calculus. For information about
% chebfun2v objects and vector calculus see Chapters 5 and 6 of this
% guide.

%% 1.3 CONSTRUCTING CHEBFUN2 OBJECTS
% A chebfun2 is constructed by supplying the Chebfun2 constructor with a
% function handle or string. The default rectangular domain of a chebfun2 is 
% $[-1,1]\times [-1,1]$. (An example showing how to specify a different domain is 
% given at the end of this chapter.) For example, here is how to make a chebfun2 that
% represents $\cos(xy)$ on $[-1,1]\times[-1,1]$ and then plot it. 

f = chebfun2(@(x,y) cos(x.*y)); 
plot(f), zlim([-2 2])

%% 
% There are several different ways to plot a chebfun2, such as plot,
% contour, surf, and mesh.  Here is a contour plot of $f$:

contour(f), axis square

%%
% One way to find the rank of the approximant used to represent $f(x,y)$ is the
% following:

length(f)

%%
% Alternatively, more information can be given by displaying the chebfun2
% object: 

f

%%
% The corner values are the values of the chebfun2 at 
% $(-1,-1)$, $(-1,1)$, $(1,-1)$, and $(1,1)$, in that order. The vertical scale is
% used by operations to aim for essentially machine precision relative 
% to that number. 

%% 1.4 BASIC OPERATIONS
% Once we have a chebfun2 we can compute
% interesting quantities such as its definite double integral:

sum2(f)

%%
% We can compare this with the true answer obtained by calculus:

exact = 3.784332281468732

%%
% We can also evaluate a chebfun2 at a point $(x,y)$, or along a line.
% When evaluating along a line a chebfun is returned because the answer is
% a function of one variable.

%%
% Evaluation at a point:

x = 2*rand - 1; y = 2*rand - 1; 
f(x,y) 
%% 
% Evaluation along the line $y = \pi/6$:

f(:,pi/6)

%% 
% There are plenty of other questions that may be of interest.  For
% instance, what are the zero contours of $f(x,y) - .95$? 

r = roots(f-.95);
plot(r), axis square, title('Zero contours of f-.95')

%%
% What is the partial derivative $\partial f/\partial y$? 

fy = diff(f,1,1);
plot(fy)

%%
% The syntax for the DIFF command can cause confusion because we are
% following the matrix syntax in Matlab. We also offer DIFFX(f,k) and 
% DIFFY(f,k) which differentiate $f(x,y)$ k-times in the first and 
% second variable, respectively.

%%
% What is the mean value of $f(x,y)$ on $[-1,1]\times[-1,1]$? 

mean2(f) 

%% 1.5 CHEBFUN2 METHODS
% There are over 100 methods that can be applied to chebfun2 objects. For a
% complete list type:

methods chebfun2

%% 
% Most of these commands have been overloaded from Matlab. 
% More information about a Chebfun2 command can be found with the help 
% command; for instance

help chebfun2/max2

%% 1.6 OBJECT COMPOSITION
% So far, in this chapter, chebfun2 objects have been constructed explicitly via the
% command chebfun2(...). However, another useful way to construct new
% chebfun2 objects is by composing them together with operations such as 
% '+', '-', '.*', and '.^'. For instance,
  
x = chebfun2(@(x,y) x, [-2 3 -4 4]); 
y = chebfun2(@(x,y) y, [-2 3 -4 4]);   

f = 1./( 2 + cos(.25 + x.^2.*y + y.^2) );
contour(f), axis square

%% 1.7 WHAT TO DO NOW
% To find out more about Chebfun2 you can continue reading this guide, or 
% have a look at the Chebfun2 Examples. This guide and the Chebfun2 
% Examples are written as publishable m-files. For example, you can publish
% this chapter of the guide by typing publish('guide1.m').   

%% 1.8 REFERENCES 
%% 
% [Battles & Trefethen 2004] Z. Battles and L. N. Trefethen, "An extension
% of Matlab to continuous functions and operators", SIAM Journal on
% Scientific Computing, 25 (2004), 1743-1770.
%%
% [Bebendorf 2008] M. Bebendorf, Hierarchical Matrices: A Means to 
% Efficiently Solve Elliptic Boundary Value Problems, Springer, 2008.
%%
% [Carvajal, Chapman, & Geddes 2008] O. A. Carvajal, F. W. Chapman and 
% K. O. Geddes, Hybrid symbolic-numeric integration in multiple dimensions 
% via tensor-product series, Proceedings of ISSAC'05, M. Kauers, ed., 
% ACM Press, 2005, pp.84-91.
%% 
% [Townsend & Trefethen 2013] A. Townsend and L. N. Trefethen, An extension
% of Chebfun to two dimensions, submitted. 
%% 
% [Townsend & Trefethen March 2013] A. Townsend and L. N. Trefethen, Gaussian
% elimination as an iterative algorithm, SIAM News, March 2013.
%%
% [Trefethen & others] Chebfun Version 4.2, The Chebfun Development Team, 
% 2011, http://www.maths.ox.ac.uk/chebfun/

##### SOURCE END #####
--></body></html>