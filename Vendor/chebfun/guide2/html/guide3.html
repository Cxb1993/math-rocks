
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>CHEBFUN2 GUIDE 3: ROOTFINDING AND OPTIMISATION</title><meta name="generator" content="MATLAB 8.1"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2013-11-26"><meta name="DC.source" content="guide3.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, tt, code { font-size:12px; }
pre { margin:0px 0px 20px; }
pre.error { color:red; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>CHEBFUN2 GUIDE 3: ROOTFINDING AND OPTIMISATION</h1><!--introduction--><p>A. Townsend, March 2013</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">3.1 ZERO CONTOURS</a></li><li><a href="#4">3.2 ROOTS</a></li><li><a href="#7">3.3 INTERSECTIONS OF CURVES</a></li><li><a href="#9">3.4 GLOBAL OPTIMISATION: MAX2, MIN2, AND MINANDMAX2</a></li><li><a href="#12">3.5 CRITICAL POINTS</a></li><li><a href="#14">3.6 INFINITY NORM</a></li><li><a href="#15">3.7 MORE DETAILS</a></li><li><a href="#16">3.8 REFERENCES</a></li></ul></div><h2>3.1 ZERO CONTOURS<a name="1"></a></h2><p>Chebfun2 comes with the capability to compute the zero contours of a function of two variables. For example, we can compute a representation of Trott's curve, an important example from algebraic geometry [Trott 1997].</p><pre class="codeinput">x = chebfun2(@(x,y) x); y = chebfun2(@(x,y) y);
trott = 144*(x.^4+y.^4)-225*(x.^2+y.^2) + 350*x.^2.*y.^2+81;
r = roots(trott);
plot(r), axis([-1 1 -1 1]), axis <span class="string">square</span>
</pre><img vspace="5" hspace="5" src="guide3_01.png" alt=""> <p>The zero curves are represented as complex valued chebfuns (see Chapter 2 of the guide). For example,</p><pre class="codeinput">r(:,1)
</pre><pre class="codeoutput">ans = 
   chebfun column (1 smooth piece)
       interval       length   endpoint values   
[      -1,       1]     2489    complex values   
vertical scale =   1 
</pre><p>The zero contours of a function are computed by Chebfun2 to plotting accuracy and they are typically not accurate to machine precision.</p><h2>3.2 ROOTS<a name="4"></a></h2><p>Chebfun2 also comes with the capability of finding zeros of bivariate systems, i.e., the solutions to   <img src="guide3_eq50840.png" alt="$$f(x,y) = g(x,y) = 0.$">$ If the roots command is supplied with one chebfun2, it computes the zero contours of that function (as in section 3.1). However, if it is supplied with two chebfun2 objects, such as roots(f,g), then it computes the roots of the bivariate system. Generically, these are isolated points.</p><p>What points on the Trott's curve intersect with the circle of radius 0.9?</p><pre class="codeinput">g = chebfun2(@(x,y) x.^2 + y.^2 - .9^2);  <span class="comment">% circle of radius 0.9</span>
r = roots(trott,g);
plot(roots(trott),<span class="string">'b'</span>), hold <span class="string">on</span>
plot(roots(g),<span class="string">'r'</span>)
plot(r(:,1),r(:,2),<span class="string">'.k'</span>,<span class="string">'markersize'</span>,20)  <span class="comment">% point intersections</span>
axis([-1 1 -1 1]), axis <span class="string">square</span>, hold <span class="string">off</span>
</pre><img vspace="5" hspace="5" src="guide3_02.png" alt=""> <p>The solution to bivariate polynomial systems and intersections of curves, are typically computed to full machine precision.</p><h2>3.3 INTERSECTIONS OF CURVES<a name="7"></a></h2><p>The determination of the intersections of real parameterised complex curves can be expressed as a bivariate rootfinding problem.  For instance, here are the intersections between the 'splat' curve [Guettel Example 2010] and a 'figure-of-eight' curve.</p><pre class="codeinput">t = chebfun(<span class="string">'t'</span>,[0,2*pi]);
splat = exp(1i*t) + (1+1i)*sin(6*t).^2;     <span class="comment">% splat curve</span>
figOfAte = cos(t) + 1i*sin(2*t);            <span class="comment">% figure of eight curve</span>
plot(splat), hold <span class="string">on</span>, plot(figOfAte,<span class="string">'r'</span>), axis <span class="string">equal</span>

f = chebfun2(@(s,t) splat(t) - figOfAte(s),[0 2*pi 0 2*pi]); <span class="comment">% rootfinding</span>
r = roots(real(f),imag(f));                 <span class="comment">% calculate intersections</span>
plot(real(splat(r(:,2))),imag(splat(r(:,2))),<span class="string">'.k'</span>,<span class="string">'markersize'</span>,20)
hold <span class="string">off</span>
</pre><img vspace="5" hspace="5" src="guide3_03.png" alt=""> <p>Chebfun2 uses an algorithm based the resultant method, see [Nakatsukasa, Noferini &amp; Townsend 2013], [Nakatsukasa, Noferini &amp; Townsend Example 2013], and [Townsend Example 2013].</p><h2>3.4 GLOBAL OPTIMISATION: MAX2, MIN2, AND MINANDMAX2<a name="9"></a></h2><p>Chebfun2 also provides functionality for global optimisation. Here is a non-trivial example, where we plot the computed maximum as a blue dot and the minimum as a red dot.</p><pre class="codeinput">f = chebfun2(@(x,y) sin(30*x.*y) + sin(10*y.*x.^2) + exp(-x.^2-(y-.8).^2));
[mn mnloc] = min2(f);
[mx mxloc] = max2(f);
plot(f), hold <span class="string">on</span>
plot3(mnloc(1),mnloc(2),mn,<span class="string">'.r'</span>,<span class="string">'markersize'</span>,40)
plot3(mxloc(1),mxloc(2),mx,<span class="string">'.b'</span>,<span class="string">'markersize'</span>,40)
zlim([-6 6]), hold <span class="string">off</span>
</pre><img vspace="5" hspace="5" src="guide3_04.png" alt=""> <p>If both the global maximum and minimum are required it is roughly twice as fast to compute them at the same time by using the minandmax2 command. For instance,</p><pre class="codeinput">tic; [mn mnloc] = min2(f);  [mx mxloc] = max2(f); t=toc;
fprintf(<span class="string">'min2 and max2 separately = %5.3fs\n'</span>,t)
tic; [Y X] = minandmax2(f); t=toc;
fprintf(<span class="string">'minandmax2 command = %5.3fs\n'</span>,t)
</pre><pre class="codeoutput">min2 and max2 separately = 0.131s
minandmax2 command = 0.066s
</pre><p>For high accuracy the commands MIN2, MAX2, and MINANDMAX2 require the Optimisation Toolbox in Matlab.</p><h2>3.5 CRITICAL POINTS<a name="12"></a></h2><p>The critical points of smooth function of two variables can be located by finding the zeros of <img src="guide3_eq91311.png" alt="$\partial f/ \partial y = \partial f / \partial x = 0$">. This is a rootfinding problem.  For example,</p><pre class="codeinput">f = chebfun2(@(x,y) (x.^2-y.^3+1/8).*sin(10*x.*y));
r = roots(gradient(f));                  <span class="comment">% critical points</span>
plot(roots(diff(f,1,2)),<span class="string">'b'</span>), hold <span class="string">on</span>    <span class="comment">% plot zero contours of f_x</span>
plot(roots(diff(f)),<span class="string">'r'</span>)                 <span class="comment">% plot zero contours of f_y</span>
plot(r(:,1),r(:,2),<span class="string">'k.'</span>,<span class="string">'MarkerSize'</span>,30) <span class="comment">% plot extrema</span>
axis <span class="string">square</span>
</pre><img vspace="5" hspace="5" src="guide3_05.png" alt=""> <p>There is a new command here called gradient that computes the gradient vector and represents it as a chebfun2v object. The roots command then solves for the isolated roots of the bivariate polynomial system represented in the chebfun2v representing the gradient. For more information about the gradient command see Chapter 5 of this guide.</p><h2>3.6 INFINITY NORM<a name="14"></a></h2><p>The infinity norm of a function is the maximum absolute value in its domain. It can be computed by passing an optional argument to the norm command.</p><pre class="codeinput">f = chebfun2(@(x,y) sin(30*x.*y));
norm(f,inf)
</pre><pre class="codeoutput">ans =
  -0.988031624092863
</pre><h2>3.7 MORE DETAILS<a name="15"></a></h2><p>The algorithms behind rootfinding and optimization are relatively involved, so for more details, please read [Townsend &amp; Trefethen 2013].</p><h2>3.8 REFERENCES<a name="16"></a></h2><p>[Guettel Example 2010] S. Guettel, <a href="http://www2.maths.ox.ac.uk/chebfun/examples/geom/html/Area.shtml">http://www2.maths.ox.ac.uk/chebfun/examples/geom/html/Area.shtml</a></p><p>[Nakatsukasa, Noferini &amp; Townsend Example 2013] Y. Nakatsukasa, V. Noferini and A. Townsend, Computing common roots of two bivariate functions, Chebfun Example, February 2013.</p><p>[Nakatsukasa, Noferini &amp; Townsend 2013] Y. Nakatsukasa, V. Noferini and A. Townsend, Computing the common zeros of two bivariate functions via Bezout resultants, (2013).</p><p>[Townsend &amp; Trefethen 2013] A. Townsend and L. N. Trefethen, An extension of Chebfun to two dimensions, submitted.</p><p>[Townsend Example 2013] A. Townsend, A new bivariate rootfinder in Chebfun2 based on Bezout resultants, May 2013.</p><p>[Trott 2007] M. Trott, Applying Groebner Basis to Three Problems in Geometry, Mathematica in Education and Research, 6 (1997), pp.15-28.</p><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2013a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% CHEBFUN2 GUIDE 3: ROOTFINDING AND OPTIMISATION
% A. Townsend, March 2013

%% 3.1 ZERO CONTOURS 
% Chebfun2 comes with the capability to compute the zero contours of a
% function of two variables. For example, we can compute a representation
% of Trott's curve, an important example from algebraic geometry [Trott 1997].

x = chebfun2(@(x,y) x); y = chebfun2(@(x,y) y); 
trott = 144*(x.^4+y.^4)-225*(x.^2+y.^2) + 350*x.^2.*y.^2+81;
r = roots(trott);
plot(r), axis([-1 1 -1 1]), axis square

%%
% The zero curves are represented as complex valued chebfuns (see Chapter 2
% of the guide). For example, 

r(:,1)

%%
% The zero contours of a function are computed by Chebfun2 to plotting
% accuracy and they are typically not accurate to machine precision. 

%% 3.2 ROOTS
% Chebfun2 also comes with the capability of finding zeros of bivariate
% systems, i.e., the solutions to 
%   $$f(x,y) = g(x,y) = 0.$$ 
% If the roots command is supplied with one chebfun2, it computes the zero
% contours of that function (as in section 3.1). However, if it is supplied
% with two chebfun2 objects, such as roots(f,g), then it 
% computes the roots of the bivariate system. Generically, these are
% isolated points.

%%
% What points on the Trott's curve intersect with the circle of radius 0.9?

g = chebfun2(@(x,y) x.^2 + y.^2 - .9^2);  % circle of radius 0.9
r = roots(trott,g); 
plot(roots(trott),'b'), hold on
plot(roots(g),'r')
plot(r(:,1),r(:,2),'.k','markersize',20)  % point intersections
axis([-1 1 -1 1]), axis square, hold off

%%
% The solution to bivariate polynomial systems and intersections of curves, are
% typically computed to full machine precision.

%% 3.3 INTERSECTIONS OF CURVES
% The determination of the intersections of real parameterised complex curves can be expressed as a
% bivariate rootfinding problem.  For instance, here are the intersections
% between the 'splat' curve [Guettel Example 2010] and a 'figure-of-eight'
% curve. 

t = chebfun('t',[0,2*pi]);
splat = exp(1i*t) + (1+1i)*sin(6*t).^2;     % splat curve
figOfAte = cos(t) + 1i*sin(2*t);            % figure of eight curve
plot(splat), hold on, plot(figOfAte,'r'), axis equal

f = chebfun2(@(s,t) splat(t) - figOfAte(s),[0 2*pi 0 2*pi]); % rootfinding
r = roots(real(f),imag(f));                 % calculate intersections
plot(real(splat(r(:,2))),imag(splat(r(:,2))),'.k','markersize',20)
hold off

%%
% Chebfun2 uses an algorithm based the resultant method, see
% [Nakatsukasa, Noferini & Townsend 2013], 
% [Nakatsukasa, Noferini & Townsend Example 2013], and 
% [Townsend Example 2013].

%% 3.4 GLOBAL OPTIMISATION: MAX2, MIN2, AND MINANDMAX2
% Chebfun2 also provides functionality for global optimisation. Here is
% a non-trivial example, where we plot the computed maximum as a blue dot
% and the minimum as a red dot. 

f = chebfun2(@(x,y) sin(30*x.*y) + sin(10*y.*x.^2) + exp(-x.^2-(y-.8).^2));
[mn mnloc] = min2(f); 
[mx mxloc] = max2(f); 
plot(f), hold on 
plot3(mnloc(1),mnloc(2),mn,'.r','markersize',40)
plot3(mxloc(1),mxloc(2),mx,'.b','markersize',40) 
zlim([-6 6]), hold off

%% 
% If both the global maximum and minimum are required it is roughly twice
% as fast to compute them at the same time by using the minandmax2 command.
% For instance, 

tic; [mn mnloc] = min2(f);  [mx mxloc] = max2(f); t=toc;
fprintf('min2 and max2 separately = %5.3fs\n',t)
tic; [Y X] = minandmax2(f); t=toc;
fprintf('minandmax2 command = %5.3fs\n',t)

%%
% For high accuracy the commands MIN2, MAX2, and MINANDMAX2 require the 
% Optimisation Toolbox in Matlab. 

%% 3.5 CRITICAL POINTS
% The critical points of smooth function of two variables can be located 
% by finding the zeros of $\partial f/ \partial y = \partial f / \partial x = 0$.   
% This is a rootfinding problem.  For example,

f = chebfun2(@(x,y) (x.^2-y.^3+1/8).*sin(10*x.*y));
r = roots(gradient(f));                  % critical points
plot(roots(diff(f,1,2)),'b'), hold on    % plot zero contours of f_x
plot(roots(diff(f)),'r')                 % plot zero contours of f_y
plot(r(:,1),r(:,2),'k.','MarkerSize',30) % plot extrema
axis square

%% 
% There is a new command here called gradient that computes the gradient
% vector and represents it as a chebfun2v object.
% The roots command then solves for the isolated roots of the bivariate 
% polynomial system represented in the chebfun2v representing the gradient.  
% For more information about the gradient command see Chapter 5 of this guide. 
 
%% 3.6 INFINITY NORM
% The infinity norm of a function is the maximum absolute value in its 
% domain. It can be computed by passing an optional
% argument to the norm command.  

f = chebfun2(@(x,y) sin(30*x.*y));
norm(f,inf)

%% 3.7 MORE DETAILS 
% The algorithms behind rootfinding and optimization are relatively
% involved, so for more details, please read [Townsend & Trefethen 2013].

%% 3.8 REFERENCES
%%
% [Guettel Example 2010] S. Guettel, 
% http://www2.maths.ox.ac.uk/chebfun/examples/geom/html/Area.shtml
%% 
% [Nakatsukasa, Noferini & Townsend Example 2013] Y. Nakatsukasa, V. Noferini
% and A. Townsend, Computing common roots of two bivariate functions,
% Chebfun Example, February 2013. 
%%
% [Nakatsukasa, Noferini & Townsend 2013] Y. Nakatsukasa, V. Noferini
% and A. Townsend, Computing the common zeros of two bivariate functions
% via Bezout resultants, (2013). 
%%
% [Townsend & Trefethen 2013] A. Townsend and L. N. Trefethen, An extension
% of Chebfun to two dimensions, submitted. 
%%
% [Townsend Example 2013] A. Townsend, A new bivariate rootfinder in 
% Chebfun2 based on Bezout resultants, May 2013. 
%%
% [Trott 2007] M. Trott, Applying Groebner Basis to Three Problems in
% Geometry, Mathematica in Education and Research, 6 (1997), pp.15-28.
##### SOURCE END #####
--></body></html>