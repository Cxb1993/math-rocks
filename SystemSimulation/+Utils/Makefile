SELF_DIRECTORY = $(dir $(lastword $(MAKEFILE_LIST)))

INCLUDE_DIRECTORY = $(ESLF_DIRECTORY)../../Include/
HOTSPOT_DIRECTORY = $(SELF_DIRECTORY)HotSpot/
HOTSPOT_SOURCES   = $(HOTSPOT_DIRECTORY)Sources/
HOTSPOT_LIBRARY   = $(HOTSPOT_SOURCES)libhotspot.a

MEX ?= mex
MEX_FLAGS = -outdir $(SELF_DIRECTORY) -I$(HOTSPOT_DIRECTORY) -I$(INCLUDE_DIRECTORY) -I$(HOTSPOT_SOURCES) CFLAGS='-std=c99'

COMMON_SOURCES = $(HOTSPOT_DIRECTORY)HotSpot.cpp

constructHotSpot: $(HOTSPOT_LIBRARY)
	$(MEX) $(MEX_FLAGS) $(SELF_DIRECTORY)constructHotSpot.cpp $(COMMON_SOURCES) $(HOTSPOT_LIBRARY)

$(HOTSPOT_LIBRARY):
	$(MAKE) all -C $(HOTSPOT_DIRECTORY)
