SELF_DIRECTORY = $(dir $(lastword $(MAKEFILE_LIST)))

INCLUDE_DIRECTORY   = $(ESLF_DIRECTORY)../../Include/
INTERFACE_DIRECTORY = $(SELF_DIRECTORY)Interface/
HOTSPOT_LIBRARY     = $(INTERFACE_DIRECTORY)hotspot/libhotspot.a

MEX ?= mex
MEX_FLAGS = -outdir $(SELF_DIRECTORY) -I$(INCLUDE_DIRECTORY) -I$(INTERFACE_DIRECTORY) CFLAGS='-std=c99'

COMMON_SOURCES = $(INTERFACE_DIRECTORY)HotSpot.cpp

constructModel: $(HOTSPOT_LIBRARY)
	$(MEX) $(MEX_FLAGS) $(SELF_DIRECTORY)constructModel.cpp $(COMMON_SOURCES) $(HOTSPOT_LIBRARY)

$(HOTSPOT_LIBRARY):
	$(MAKE) all -C $(INTERFACE_DIRECTORY)
